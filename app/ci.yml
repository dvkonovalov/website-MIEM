app-flake8:
  stage: test
  image: python:3
  before_script:
    - pip install flake8 flake8-docstrings
  script:
    - flake8 --config app/.flake8 --docstring-convention google app/
  tags:
    - vkr-runner
  rules:
    - if: $CI_PIPELINE_SOURCE == 'merge_request_event' && $CI_MERGE_REQUEST_TARGET_BRANCH_NAME == 'main'
      changes:
        - app/**/*
    - if: $CI_COMMIT_BRANCH == 'main'

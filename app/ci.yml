app-flake8:
  stage: test
  image: python:3
  before_script:
    - pip install flake8 wemake-python-styleguide
  script:
    - cd app
    - flake8 --config .flake8
  tags:
    - 1300-runner
  rules:
    - if: $CI_PIPELINE_SOURCE == 'merge_request_event' && $CI_MERGE_REQUEST_TARGET_BRANCH_NAME == 'main'
      changes:
        - app/**/*
    - if: $CI_COMMIT_BRANCH == 'main'
